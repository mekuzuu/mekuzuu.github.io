---
title: "Go Tech Talk【サイバーエージェント x ミラティブ】に参加した"
date: 2022-04-19T18:08:58+09:00
draft: false
---

先日、Goを題材とした技術イベントに参加した時のメモ。  
あまりうまくメモを取ることができなかったけど、残しておく。

# イベント概要
|  |  |
| - | - |
| 日時 | 2022/04/14 |
| イベント名 | Go Tech Talk【サイバーエージェント x ミラティブ】 |
| 詳細 | https://mirrativ.connpass.com/event/243037/ |

# 発表
### Go + GitHubActions でリリースフローを改善した話
* 現状は設定ファイルのtagを書き換えたのをトリガにGithub Actionsがtagを打つ
* そして、CIはtagが打たれたのをトリガにデプロイする
* 設定ファイルのtagを手動で書き換えるの手間なので、自動化したい
* Github ActionsのWorkflow Dispatchを使っている
* yamlのI/Oでハマった
* goccy/go-yamlを使って解決
  * https://github.com/goccy/go-yaml

### ミラティブのサーバサイドをGo + Clean Architectureに再設計した話
* https://tech.mirrativ.stream/entry/2020/11/30/142354
* 求められる要件
  * リアルタイム性/即時性
  * データ量多い
  * アクセスの時間的局所性が高い
* 元々MVC + Serviceだけど、依存関係がスパゲティ
* Clean Architectureでコンポーネントの依存性を一方向にすることを最重要視
* PerlからGoへ移行している

### GoでContinuous Profilingをやっている話
* https://tech.mirrativ.stream/entry/2020/12/18/115553
* 本番環境で継続的にProfilingすること
* Profilingすることで問題が発生する前後の状態を比較できる
* pprofを採用
* オーバヘッドが小さいので、本番環境でも利用できる
* しかし、Profiling結果の保存先、保存したProfiling結果の検索・抽出方法が課題としてあった
* そこで、profefeというOSSを導入して解決
  * https://github.com/profefe/profefe

# パネルトーク
### 技術的に大変だったことは
* JavaはSpringなどの有名なフレームワークがあって便利だけど、Goはないので自前でがんばったりする必要があるところ
* 二重メンテが必要になるので辛い

### Go未経験メンバーのキャッチアップスピードを早める工夫は
* Tour of Go、Effectiv Go
* とにかく実戦投入
* あまり工夫してない（言語仕様がシンプル、lintもあるので変なコードか出にくい）
* Java書いている人がGo書くと、Javaっぽいコードが散見されるらしい

### 最近のHot Topicは
* Go Generics何に使おう問題（ないのが当たり前だったから思いつかない）

# 感想
* 総じて面白かった
* CAは入社2年目くらいの人が堂々と発表&パネルトークしていて、おじさんは尊敬の念を抱いた
* Genericsを何に使うかパッと思いつかないあたり、同じことを思っていて安心した
* ミラティブのクリーンアーキテクチャの発表は、2020/11/30の技術ブログのネタと同じっぽいけど、まだ完全にGoへは移行しきれてないということなのかな
* リリースフローを改善したってやつは、どれくらい効率化できたかもう少し詳しく知りたかった（聞けばよかった）

